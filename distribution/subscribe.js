'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _toConsumableArray2=require('babel-runtime/helpers/toConsumableArray');var _toConsumableArray3=_interopRequireDefault(_toConsumableArray2);var _defineProperty2=require('babel-runtime/helpers/defineProperty');var _defineProperty3=_interopRequireDefault(_defineProperty2);var _extends3=require('babel-runtime/helpers/extends');var _extends4=_interopRequireDefault(_extends3);var _stringify=require('babel-runtime/core-js/json/stringify');var _stringify2=_interopRequireDefault(_stringify);var _getPrototypeOf=require('babel-runtime/core-js/object/get-prototype-of');var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=require('babel-runtime/helpers/classCallCheck');var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _possibleConstructorReturn2=require('babel-runtime/helpers/possibleConstructorReturn');var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=require('babel-runtime/helpers/inherits');var _inherits3=_interopRequireDefault(_inherits2);var _rxjs=require('rxjs');var _preact=require('preact');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=function(store){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return function(TargetComponent){return function(_TargetComponent){(0,_inherits3.default)(_class2,_TargetComponent);function _class2(){(0,_classCallCheck3.default)(this,_class2);var _this=(0,_possibleConstructorReturn3.default)(this,(_class2.__proto__||(0,_getPrototypeOf2.default)(_class2)).call(this));_this.stores=store.length?store:[store];_this.filterState=function(state){return(0,_stringify2.default)(args.reduce(function(acc,curr){return(0,_extends4.default)({},acc,(0,_defineProperty3.default)({},curr,state[curr]))},{}))};_this.filterStores=function(stores){return args.length?_rxjs.Observable.merge.apply(_rxjs.Observable,(0,_toConsumableArray3.default)(stores.map(function($){return $.startWith({}).distinctUntilChanged(function(a,b){return a===b},_this.filterState.bind(_this))}))):_rxjs.Observable.merge.apply(_rxjs.Observable,(0,_toConsumableArray3.default)(stores))};_this.componentDidMount=function(){return _this.subscription=_this.filterStores(_this.stores).subscribe(_this.setState.bind(_this))};_this.componentWillUnmount=function(){return _this.subscription.unsubscribe()};_this.shouldComponentUpdate=function(prevState,nextState){return(0,_stringify2.default)(prevState)!==(0,_stringify2.default)(nextState)};_this.render=function(props,state){return(0,_preact.h)(TargetComponent,(0,_extends4.default)({},props,state))};return _this}return _class2}(TargetComponent)}};
